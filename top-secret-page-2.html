<html>
  <body>
    <h1>Liam's top secret page 2</h1>
    <h2>Average positive range of recent candles</h2>
    <p>The idea being that you might be able to grab a certain percent with reasonable safety, or at least a decent enough success rate to make a profit on average.</p>
    <p>I wonder what this looks like if it has a standard deviation score too? Then it could be interesting to go through all coins looking for the highest positive range and lowest standard deviation.</p>
    <input id="fetchUrlInput" type="text" value="https://api.binance.com/api/v3/klines?symbol=BTCUSDT&interval=4h&limit=5" />
    <button onclick="doYoBinnis()">Bang</button>
    <pre id="loggingArea"></pre>
    <script>
        var pc = (a, b) => {
            if (a === b) return 0; // avoid any floating point crazyness
            return (100 - (b / (a / 100))) * -1;
        }

        const doYoBinnis = () => {
            fetch(fetchUrlInput.value).then(d => d.json()).then(data => {
                var averagePositiveRange = data.map(c => c[2] - c[1]).reduce((a,b) => a + b)/data.length;
                var averageNegativeRange = data.map(c => c[3] - c[1]).reduce((a,b) => a + b)/data.length;
                var averagePositiveRangePercent = data.map(c => pc(c[1], c[2])).reduce((a,b) => a + b)/data.length;
                var averageNegativeRangePercent = data.map(c => pc(c[1], c[3])).reduce((a,b) => a + b)/data.length;
                loggingArea.innerHTML = `+${averagePositiveRangePercent.toFixed(2)}%, ${averageNegativeRangePercent.toFixed(2)}% | +${averagePositiveRange.toFixed(2)}, ${averageNegativeRange.toFixed(2)}`;
            })
        }
    </script>
  </body>
</html>
